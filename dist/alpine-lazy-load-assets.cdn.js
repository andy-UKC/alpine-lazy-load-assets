(()=>{function l(s){s.store("lazyLoadedAssets",{loaded:new Set,check(e){return Array.isArray(e)?e.every(t=>this.loaded.has(t)):this.loaded.has(e)},markLoaded(e){Array.isArray(e)?e.forEach(t=>this.loaded.add(t)):this.loaded.add(e)}});function i(e){return new CustomEvent(e,{bubbles:!0,composed:!0,cancelable:!0})}async function m(e,t){if(document.querySelector(`link[href="${e}"]`)||s.store("lazyLoadedAssets").check(e))return;let o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,t&&(o.media=t),document.head.append(o),await new Promise((d,a)=>{o.onload=()=>{s.store("lazyLoadedAssets").markLoaded(e),d()},o.onerror=()=>{a(new Error(`Failed to load CSS: ${e}`))}})}async function u(e,t){if(document.querySelector(`script[src="${e}"]`)||s.store("lazyLoadedAssets").check(e))return;let o=document.createElement("script");o.src=e,t.has("body-start")?document.body.prepend(o):document[t.has("body-end")?"body":"head"].append(o),await new Promise((d,a)=>{o.onload=()=>{s.store("lazyLoadedAssets").markLoaded(e),d()},o.onerror=()=>{a(new Error(`Failed to load JS: ${e}`))}})}s.directive("load-css",(e,{expression:t},{evaluate:o})=>{let d=o(t),a=e.media,n=e.getAttribute("data-dispatch");Promise.all(d.map(r=>m(r,a))).then(()=>{console.log("All CSS files loaded!"),n&&(console.log("dispatching event: "+n+"-css"),window.dispatchEvent(i(n+"-css")))}).catch(r=>{console.error(r)})}),s.directive("load-js",(e,{expression:t,modifiers:o},{evaluate:d})=>{let a=d(t),n=new Set(o),r=e.getAttribute("data-dispatch");Promise.all(a.map(c=>u(c,n))).then(()=>{console.log("All JS files loaded!"),r&&(console.log("dispatching event: "+r+"-js"),window.dispatchEvent(i(r+"-js")))}).catch(c=>{console.error(c)})})}document.addEventListener("alpine:initializing",()=>{l(window.Alpine)});})();
