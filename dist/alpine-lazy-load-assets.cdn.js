(()=>{function b(c){c.store("lazyLoadedAssets",{loaded:new Set,check(e){return Array.isArray(e)?e.every(t=>this.loaded.has(t)):this.loaded.has(e)},markLoaded(e){Array.isArray(e)?e.forEach(t=>this.loaded.add(t)):this.loaded.add(e)}});function u(e){return new CustomEvent(e,{bubbles:!0,composed:!0,cancelable:!0})}function m(e,t={},r,n){let o=document.createElement(e);for(let[s,a]of Object.entries(t))o[s]=a;return r&&(n?r.insertBefore(o,n):r.appendChild(o)),o}function f(e,t,r={},n=null,o=null){let s=e==="link"?`link[href="${t}"]`:`script[src="${t}"]`;if(document.querySelector(s)||c.store("lazyLoadedAssets").check(t))return Promise.resolve();let a=m(e,{...r,href:t},n,o);return new Promise((d,i)=>{a.onload=()=>{c.store("lazyLoadedAssets").markLoaded(t),d()},a.onerror=()=>{i(new Error(`Failed to load ${e}: ${t}`))}})}async function y(e,t,r=null,n=null){let o={type:"text/css",rel:"stylesheet"};t&&(o.media=t);let s=document.head,a=null;if(r&&n){let d=document.querySelector(`link[href*="${n}"]`);d?(s=d.parentNode,a=r==="before"?d:d.nextSibling):console.warn(`Target (${n}) not found for ${e}. Appending to head.`)}await f("link",e,o,s,a)}async function A(e,t,r=null,n=null){let o,s;r&&n&&(o=document.querySelector(`script[src*="${n}"]`),o?s=r==="before"?o:o.nextSibling:console.warn(`Target (${n}) not found for ${e}. Appending to body.`));let a=t.has("body-start")?"prepend":"append";await f("script",e,{},o||document[t.has("body-end")?"body":"head"],s)}c.directive("load-css",(e,{expression:t},{evaluate:r})=>{let n=r(t),o=e.media,s=e.getAttribute("data-dispatch"),a=e.getAttribute("data-css-before")?"before":e.getAttribute("data-css-after")?"after":null,d=e.getAttribute("data-css-before")||e.getAttribute("data-css-after")||null;Promise.all(n.map(i=>y(i,o,a,d))).then(()=>{s&&window.dispatchEvent(u(s+"-css"))}).catch(i=>{console.error(i)})}),c.directive("load-js",(e,{expression:t,modifiers:r},{evaluate:n})=>{let o=n(t),s=new Set(r),a=e.getAttribute("data-js-before")?"before":e.getAttribute("data-js-after")?"after":null,d=e.getAttribute("data-js-before")||e.getAttribute("data-js-after")||null,i=e.getAttribute("data-dispatch");Promise.all(o.map(l=>A(l,s,a,d))).then(()=>{i&&window.dispatchEvent(u(i+"-js"))}).catch(l=>{console.error(l)})})}document.addEventListener("alpine:initializing",()=>{b(window.Alpine)});})();
