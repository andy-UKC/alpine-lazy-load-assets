(()=>{function b(c){c.store("lazyLoadedAssets",{loaded:new Set,check(e){return Array.isArray(e)?e.every(t=>this.loaded.has(t)):this.loaded.has(e)},markLoaded(e){Array.isArray(e)?e.forEach(t=>this.loaded.add(t)):this.loaded.add(e)}});function u(e){return new CustomEvent(e,{bubbles:!0,composed:!0,cancelable:!0})}function m(e,t={},n,r){let o=document.createElement(e);for(let[s,a]of Object.entries(t))o[s]=a;return n&&(r?n.insertBefore(o,r):n.appendChild(o)),o}function f(e,t,n={},r=null,o=null){let s=e==="link"?`link[href="${t}"]`:`script[src="${t}"]`;if(document.querySelector(s)||c.store("lazyLoadedAssets").check(t))return Promise.resolve();let a=e==="link"?{...n,href:t}:{...n,src:t},d=m(e,a,r,o);return new Promise((i,l)=>{d.onload=()=>{c.store("lazyLoadedAssets").markLoaded(t),i()},d.onerror=()=>{l(new Error(`Failed to load ${e}: ${t}`))}})}async function A(e,t,n=null,r=null){let o={type:"text/css",rel:"stylesheet"};t&&(o.media=t);let s=document.head,a=null;if(n&&r){let d=document.querySelector(`link[href*="${r}"]`);d?(s=d.parentNode,a=n==="before"?d:d.nextSibling):console.warn(`Target (${r}) not found for ${e}. Appending to head.`)}await f("link",e,o,s,a)}async function y(e,t,n=null,r=null){let o,s;n&&r&&(o=document.querySelector(`script[src*="${r}"]`),o?s=n==="before"?o:o.nextSibling:console.warn(`Target (${r}) not found for ${e}. Appending to body.`));let a=t.has("body-start")?"prepend":"append";await f("script",e,{},o||document[t.has("body-end")?"body":"head"],s)}c.directive("load-css",(e,{expression:t},{evaluate:n})=>{let r=n(t),o=e.media,s=e.getAttribute("data-dispatch"),a=e.getAttribute("data-css-before")?"before":e.getAttribute("data-css-after")?"after":null,d=e.getAttribute("data-css-before")||e.getAttribute("data-css-after")||null;Promise.all(r.map(i=>A(i,o,a,d))).then(()=>{s&&window.dispatchEvent(u(s+"-css"))}).catch(i=>{console.error(i)})}),c.directive("load-js",(e,{expression:t,modifiers:n},{evaluate:r})=>{let o=r(t),s=new Set(n),a=e.getAttribute("data-js-before")?"before":e.getAttribute("data-js-after")?"after":null,d=e.getAttribute("data-js-before")||e.getAttribute("data-js-after")||null,i=e.getAttribute("data-dispatch");Promise.all(o.map(l=>y(l,s,a,d))).then(()=>{i&&window.dispatchEvent(u(i+"-js"))}).catch(l=>{console.error(l)})})}document.addEventListener("alpine:initializing",()=>{b(window.Alpine)});})();
